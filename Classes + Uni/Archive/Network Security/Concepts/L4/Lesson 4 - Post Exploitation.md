
---

## 1. Post Exploitation in the Attack Methodology

**Slides:** 1–5

- **Network Attack Methodology:** After the attacker gains access (exploitation), they move on to _post-exploitation_ steps: persistence, data exfiltration, lateral movement, etc.
- **Cyber Kill Chain (Lockheed Martin):** Steps 5–7 focus on actions after the initial compromise: installation, command & control, and actions on objectives.
- **Goal of Post Exploitation:**
    1. **Persistence:** Maintain access for as long as needed.
    2. **Exfiltration or sabotage:** Carry out the intended attack, e.g., stealing data, destroying systems, etc.

---

## 2. Persistence Techniques

**Slides:** 6–7

- **Persistence** means the attacker wants to remain on the target system for a long time (days, weeks, or months).
- **Common Approaches:**
    - **Startup Services** (e.g., xinetd/inetd on Linux or registry run keys on Windows).
    - **Scheduled tasks** (cron jobs on Linux or scheduled tasks on Windows).
    - **Launch daemons** (macOS `plist` files).

---

## 3. Trojans & Malware

**Slides:** 8–9

- **Trojan:** A program that **appears benign** but secretly contains malicious functionality (backdoor, keylogger, etc.).
- **Delivery:** Can be installed by user error (running untrusted software), remote exploits, drive-by downloads, etc.
- **Malware Objectives:**
    - **Financial gain** (e.g., collecting credit card data).
    - **Pivot / Proxy:** Attackers launch further attacks from the compromised host.
    - **Part of a botnet** (e.g., used for DDoS).

---

## 4. Common Ports for Trojans

**Slide:** 10

|Trojan|Protocol|Common Port(s)|
|---|---|---|
|Back Orifice|UDP|31337 or 31338|
|Deep Throat|UDP|2140, 3150|
|NetBus|TCP|12345, 12346|
|GirlFriend|TCP|21544|
|NetBus 2 Pro|TCP|20034|
|MastersParadise|TCP|3129, 40421–40426|

---

## 5. Finding Listening Ports

**Slide:** 11

- **Windows:**
    
    ```powershell
    netstat -an
    netstat -an | findstr <port>
    ```
    
- **Linux:**
    
    ```bash
    netstat -anp
    netstat -anp | grep <port>
    lsof -i
    ```
    

---

## 6. Proxy Server Trojans

**Slide:** 12

- **Hidden HTTP Proxy** runs on victim’s computer.
- Allows attackers to **redirect or tunnel** traffic, obscuring the real source.

---

## 7. NetBus Trojan

**Slide:** 13

- An older, classic Windows remote-control Trojan.
- Once installed, an attacker can remotely control the system via the NetBus client.

---

## 8. Rootkits

**Slides:** 14–15

- **Rootkit:** Malicious software designed to **hide** processes, files, or registry entries from standard detection methods.
- Often used **after** a system is compromised to remain undetected.
- Types:
    - **User-Mode Rootkits** (ring 3): Intercepts calls in user space.
    - **Kernel-Mode Rootkits** (ring 0): Alters OS kernel or drivers.
    - **Others:** Firmware rootkits, bootkits, hypervisor-level, etc.

---

## 9. Netcat (nc)

**Slides:** 16–19

- Known as the **“Swiss Army Knife”** of networking.
- Can **listen** on a port (`nc -l -p <port>`) or **connect** to a remote port.
- Common uses:
    1. **File Transfers**
    2. **Backdoors** (bind a shell to a port)
    3. **Relay / Proxy** traffic
    4. **Banner grabbing** or simple port testing
- **Key Switches:**
    - `-l` → Listen mode
    - `-p` → Specify a port
    - `-e` → Execute a program upon connection (often used maliciously to spawn a shell)
    - `-u` → Use UDP instead of TCP
    - `-v` → Verbose output

---

## 10. Wrappers

**Slides:** 23–24

- **Wrapper:** A tool that **binds** malicious code (Trojan) with a seemingly normal executable.
- When the user runs the wrapped executable, it **unpacks** and runs both the legitimate program **and** the Trojan in the background.

---

## 11. Data Exfiltration & Steganography

**Slides:** 25–29

- **Data Exfiltration:** The attacker removes sensitive data from the victim environment.
- **Steganography:** Hiding data in otherwise normal files or traffic (e.g., embedding text inside images, forging unused fields in a protocol).
- **Covert Channel:** A communication channel that **hides** data inside legitimate network traffic or file structures.

---

## 12. Common Example – Tunneling Inside TCP Port 80

**Slide:** 30

- Attackers frequently **tunnel** arbitrary traffic over port 80 (HTTP) to bypass firewalls that only allow outbound TCP 80.
- **Application-layer** firewalls can sometimes detect & block suspicious tunnel traffic.

---

## 13. covert_tcp

**Slides:** 31–36

- **covert_tcp** is a _proof-of-concept_ tool that hides data in fields of the IP/TCP headers.
- **Motivation:** Even if optional fields are removed, mandatory fields like IP ID, TCP sequence, or ACK numbers can be **manipulated** to carry data.
- **Main Methods:**
    1. **IP Identification field**: Insert one character of ASCII data per packet.
    2. **TCP Sequence Number**: Place data in the sequence number, rely on “RST” or “SYN/ACK” from the target.
    3. **TCP ACK Number** (most covert): The attacker “bounces” traffic off an unwitting server, using spoofed source addresses.

---

## 14. Loki2 & Other Covert Channels

**Slides:** 38–39

- **Loki2:** Tunnels data in **ICMP** (echo/reply) or in **UDP 53** (masquerading as DNS).
- **Reverse WWW Shell:** The infected host periodically “phones home” to an external server using HTTP to retrieve commands, which looks like normal web traffic.

---

## 15. Advanced Exfiltration & DLP

**Slides:** 40–41

- **Advanced Exfiltration:** Attackers can exfiltrate via any channel—HTTP, DNS, email, cloud uploads, etc.
- **Data Loss Prevention (DLP):** Tools and techniques (host-based or network-based) that attempt to stop sensitive data from leaving the organization (e.g., scanning file uploads, emails, or blocking USB storage).

---

# Midterm-Style Practice Questions

Below are some example questions that might appear on a midterm exam covering these slides (1–41).

1. **Trojans & Ports**
    
    - _Question:_ Give an example of a commonly used port for trojans like “Back Orifice” or “NetBus.”
    - _Answer:_ Back Orifice uses UDP port **31337**, while NetBus often listens on TCP **12345**.
2. **Persistence**
    
    - _Question:_ List two ways an attacker can maintain persistence on a Linux system.
    - _Answer:_ (1) Adding a malicious entry to `/etc/crontab`, (2) modifying `inetd/xinetd` services, etc.
3. **Netcat**
    
    - _Question:_ Which `netcat` command would you use on Windows to create a persistent backdoor that launches `cmd.exe`?
    - _Answer:_
        
        ```bash
        nc -L -p 4444 -e cmd.exe
        ```
        
        (`-L` keeps listening after disconnect; `-p` is the port; `-e` executes the shell.)
4. **Rootkits**
    
    - _Question:_ What is the main difference between a _user-mode rootkit_ and a _kernel-mode rootkit_?
    - _Answer:_ A user-mode rootkit (ring 3) hooks user-space APIs and processes. A kernel-mode rootkit (ring 0) modifies the kernel or drivers, generally providing more stealth and control.
5. **covert_tcp**
    
    - _Question:_ Describe how covert_tcp can embed data in the TCP ACK Number.
    - _Answer:_ It **spoofs** the source IP to the intended receiver; the bounce server sends back a SYN/ACK or RST. The difference in the ACK fields encodes data.
6. **Steganography vs. Tunneling**
    
    - _Question:_ Compare steganography with traffic tunneling for data exfiltration.
    - _Answer:_
        - _Steganography_ embeds hidden content in apparently innocuous files or protocol fields, often at a low data rate.
        - _Tunneling_ encapsulates the real traffic in a permitted protocol like HTTP or DNS to bypass firewalls.

---

## Summary

- **Post Exploitation** includes **maintaining access** (persistence) and **carrying out objectives** (like data exfiltration).
- **Techniques** range from simply installing a Trojan to advanced covert channels such as **covert_tcp**, **Loki2**, or HTTP-based “Reverse WWW Shells.”
- **Netcat** is an extremely flexible tool for many post-exploitation tasks (data transfer, backdoors, proxies).
- **Data Loss Prevention (DLP)** aims to block unauthorized exfiltration but can be evaded by clever hiding or tunneling techniques.

	Use these notes and practice questions to prepare for your exam up to (but **not including**) the “Removal of Evidence” slides.